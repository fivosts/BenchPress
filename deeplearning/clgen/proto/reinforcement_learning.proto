// This files defines the specification of the reinforcement learning model.
syntax = "proto2";

package clgen;

option go_package = "clgenpb";
option java_multiple_files = true;
option java_outer_classname = "ReinforcementLearningProto";
option java_package = "com.clgen";

import "deeplearning/clgen/proto/model.proto";

message RLModel {
  oneof target_features {
    bool train_set = 1;
    bool random    = 2;
  }
  optional RLAgent agent          = 3;
  optional Model   language_model = 4;
}

message RLAgent {
  optional FeatureTokenizer feature_tokenizer = 1;
  optional ActionQV         action_qv         = 2;
  optional ActionLM         action_lm         = 3;
}

message FeatureTokenizer {
  optional int32 feature_max_value_token    = 1;
  optional int32 feature_singular_token_thr = 2;
  optional int32 feature_token_range        = 3;
}

message ActionQV {
  optional int32 hidden_size                = 1;
  optional int32 num_attention_heads        = 2;
  optional int32 intermediate_size          = 3;
  optional int32 num_hidden_layers          = 4;
  optional int32 max_position_embeddings    = 5;
  optional float layer_norm_eps             = 6;
  optional float hidden_dropout_prob        = 7;
}

message ActionLM {

}